<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem TV Masjid - Blue Gold Edition</title>
    <style>
        /* IMPORT FONT DIGITAL & MODERN */
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700&family=Orbitron:wght@700&display=swap');

        :root {
            /* PALET WARNA: BLUE, WHITE, GOLD */
            --bg-dark: #26436e;
            --bg-blue: #c9cfd8;
            --accent-gold: #ffd700;
            --accent-gold-dim: #b8860b;
            --text-white: #e6f1ff;
            --glass-bg: rgba(243, 245, 248, 0.7);
            --glass-border: rgba(255, 215, 0, 0.3);
        }

        body, html {
            margin: 0; padding: 0; height: 100%;
            font-family: 'Montserrat', sans-serif;
            /* GRADASI BACKGROUND SMOOTH */
            background: radial-gradient(circle at 50% 10%, #cad0db 0%, #35393f 100%);
            color: var(--text-white);
            overflow: hidden;
        }

        .wrapper {
            display: flex; flex-direction: column;
            height: 100vh; padding: 35px; box-sizing: border-box;
        }

        /* --- HEADER --- */
        .header {
            display: flex; justify-content: space-between; align-items: flex-start;
            border-bottom: 2px solid var(--accent-gold-dim);
            padding-bottom: 15px; margin-bottom: 25px;
        }

        .mosque-info h1 {
            font-size: 2.5rem; margin: 0; font-weight: 800; letter-spacing: 2px;
            background: linear-gradient(to right, #ffffff, #ffd700);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .mosque-info p { margin-top: 5px; opacity: 0.8; font-size: 1.1rem; color: #ffd700; }

        .date-box { text-align: right; }
        .date-box h2 { font-size: 1.8rem; margin: 0; color: var(--text-white); }
        .date-box p { color: var(--accent-gold); margin: 5px 0 0 0; font-weight: bold; }

        .btn-fullscreen {
            margin-top: 10px; background: transparent; border: 1px solid var(--accent-gold);
            color: var(--accent-gold); padding: 5px 15px; border-radius: 5px; cursor: pointer;
            transition: 0.3s; font-size: 0.8rem;
        }
        .btn-fullscreen:hover { background: var(--accent-gold); color: #000; }

        /* --- CONTENT UTAMA --- */
        .main-content {
            flex: 1; display: grid; grid-template-columns: 1.2fr 1fr; gap: 30px; margin-bottom: 30px;
        }

        /* JAM & COUNTDOWN */
        .clock-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            border: 1px solid rgba(255,255,255,0.1);
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        #jam-besar {
            font-family: 'Orbitron', sans-serif; /* Font Digital */
            font-size: 7rem; color: var(--text-white);
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
            line-height: 1; margin-bottom: 20px;
        }

        .countdown-box {
            background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            border-top: 1px solid var(--accent-gold-dim);
            border-bottom: 1px solid var(--accent-gold-dim);
            padding: 15px 0; width: 80%; text-align: center;
        }
        
        #label-next { font-size: 1rem; color: var(--accent-gold); letter-spacing: 3px; margin-bottom: 5px; text-transform: uppercase; }
        #timer-kecil { font-size: 3rem; font-family: 'Orbitron', monospace; color: #fff; font-weight: bold; }

        /* KONTAINER HADITS (Baru) */
        .hadits-container {
            background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(10,25,47,0.8) 100%);
            border-left: 5px solid var(--accent-gold);
            border-radius: 20px;
            padding: 40px;
            display: flex; flex-direction: column; justify-content: center;
            position: relative; overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .hadits-title {
            color: var(--accent-gold); font-weight: bold; letter-spacing: 2px; text-transform: uppercase;
            margin-bottom: 20px; font-size: 1.2rem; display: flex; align-items: center; gap: 10px;
        }
        .hadits-title::before { content: "‚ùù"; font-size: 2rem; color: var(--accent-gold); line-height: 0; }

        #hadits-content { font-size: 1.8rem; line-height: 1.5; color: #ccd6f6; font-style: italic; font-weight: 300; }
        #hadits-rawi { margin-top: 25px; font-size: 1.2rem; color: var(--text-white); font-weight: 600; text-align: right; }

        /* --- JADWAL SHOLAT --- */
        .schedule-grid {
            display: grid; grid-template-columns: repeat(6, 1fr); gap: 15px;
            margin-bottom: 3cm;
        }

        .prayer-card {
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05);
            padding: 20px 10px; border-radius: 15px; text-align: center;
            transition: all 0.4s ease;
            
        }

        .prayer-card h3 { margin: 0 0 10px 0; font-size: 1rem; color: #8892b0; text-transform: uppercase; }
        .prayer-card p { margin: 0; font-size: 2.2rem; font-weight: bold; color: var(--text-white); font-family: 'Orbitron', sans-serif; }

        /* Active State (Gold Gradient) */
        .prayer-card.next {
            background: linear-gradient(135deg, #b8860b 0%, #ffd700 100%);
            transform: translateY(-10px);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
            border: none;
        }
        .prayer-card.next h3, .prayer-card.next p { color: #020c1b; } /* Text jadi gelap biar kontras */

        /* --- OVERLAY --- */
        #overlay {
            position: fixed; inset: 0; background: #4685cb; z-index: 9999;
            display: none; flex-direction: column; justify-content: center; align-items: center;
        }
        #overlay h1 { font-size: 4rem; color: var(--accent-gold); margin-bottom: 20px; }
        #overlay-timer { font-size: 15rem; font-family: 'Orbitron'; color: #fff; line-height: 1; }

        /* --- RUNNING TEXT --- */
        .running-text {
            background: linear-gradient(90deg, #35393f 50%, #35393f 50%);
            border-top: 1px solid var(--accent-gold);
            padding: 10px 0; position: absolute; bottom: 0; width: 100%;
        }
        marquee { color: var(--accent-gold); font-size: 1.2rem; font-weight: 500; }
        /* =========================================
           TAMBAHAN: MODEM MOBILE / HP (Layar < 768px)
           Tempel di paling bawah tag <style>
           ========================================= */
        @media screen and (max-width: 768px) {
            /* Izinkan scroll di HP */
            body, html {
                overflow-y: auto !important; 
                height: auto !important;
                min-height: 100vh;
            }

            .wrapper {
                padding: 15px; /* Padding lebih kecil */
                height: auto;
                padding-bottom: 60px; /* Ruang untuk running text */
                display: block; /* Matikan flexbox full height */
            }

            /* Header Tumpuk Tengah */
            .header {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }

            .mosque-info h1 { font-size: 1.6rem; } /* Font judul lebih kecil */
            .date-box { text-align: center; margin-top: 15px; width: 100%; }
            .date-box h2 { font-size: 1.3rem; }

            /* Konten Utama Tumpuk ke Bawah */
            .main-content {
                display: block; /* Hapus grid 2 kolom */
                margin-bottom: 20px;
            }

            .clock-container { margin-bottom: 20px; }
            #jam-besar { font-size: 4.5rem; } /* Jam tidak terlalu besar */
            #timer-kecil { font-size: 2.5rem; }

            /* Hadits */
            .hadits-container { padding: 25px; margin-bottom: 20px; }
            #hadits-content { font-size: 1.2rem; }

            /* Jadwal Sholat: Grid 3 Kolom (2 Baris) */
            .schedule-grid {
                grid-template-columns: repeat(3, 1fr) !important; 
                gap: 10px;
                margin-bottom: 60px; /* Jarak agar tidak tertutup running text */
            }

            .prayer-card { padding: 10px 5px; }
            .prayer-card h3 { font-size: 0.8rem; }
            .prayer-card p { font-size: 1.4rem; }
            
            /* Overlay saat waktu habis */
            #overlay h1 { font-size: 2rem; }
            #overlay-timer { font-size: 5rem; }
        }
    </style>
</head>
<body>

    <div id="overlay">
        <h1 id="overlay-msg">MENUJU ADZAN</h1>
        <div id="overlay-timer">00:00</div>
        <p style="color: #888; font-size: 1.5rem; margin-top: 20px;">Luruskan Niat & Bersiap Menghadap Allah SWT</p>
    </div>

    <div class="wrapper">
        <div class="header">
            <div class="mosque-info">
                <h1>MASJID DARUSSALAM</h1>
                <p>üìç Desa Pemulutan Ulu Kec.Pemulutan</p>
            </div>
            <div class="date-box">
                <h2 id="tgl-masehi">-- --- ----</h2>
                <p id="tgl-hijri">Ramadhan 1447 H</p>
                <button class="btn-fullscreen" onclick="toggleFullScreen()">‚õ∂ Fullscreen</button>
            </div>
        </div>

        <div class="main-content">
            <div class="clock-container">
                <div id="jam-besar">00:00:00</div>
                <div class="countdown-box">
                    <div id="label-next">MEMUAT JADWAL...</div>
                    <div id="timer-kecil">--:--:--</div>
                </div>
            </div>

            <div class="hadits-container">
                <div class="hadits-title">Mutiara Hikmah</div>
                <div id="hadits-content">"..."</div>
                <div id="hadits-rawi">...</div>
            </div>
        </div>

        <div class="schedule-grid" id="prayer-list"></div>
    </div>

    <div class="running-text">
        <marquee scrollamount="6">
            Mohon nonaktifkan Handphone Anda selama di dalam Masjid ‚Ä¢ Jagalah kebersihan & ketertiban ‚Ä¢ Luruskan dan rapatkan Shaf Shalat ‚Ä¢ Waktu Sholat berdasarkan Kemenag RI.
        </marquee>
    </div>

<script>
    const KOTA_ID = "0601"; // Palembang
    let jadwal = {};

    const dbHadits = [
        { teks: "Sholat berjamaah lebih utama dua puluh tujuh derajat dibanding sholat sendirian.", rawi: "HR. Bukhari & Muslim" },
        { teks: "Barangsiapa membangun masjid karena Allah, Allah akan bangunkan rumah di surga.", rawi: "HR. Muslim" },
        { teks: "Senyummu di hadapan saudaramu adalah sedekah.", rawi: "HR. Tirmidzi" },
        { teks: "Sebaik-baik manusia adalah yang paling bermanfaat bagi orang lain.", rawi: "HR. Thabrani" },
        { teks: "Sesungguhnya amal itu tergantung niatnya.", rawi: "HR. Bukhari" }
    ];

    function toggleFullScreen() {
        if (!document.fullscreenElement) document.documentElement.requestFullscreen();
        else if (document.exitFullscreen) document.exitFullscreen();
    }

    // --- FUNGSI BARU: UPDATE TANGGAL HIJRIAH OTOMATIS ---
    function updateHijri() {
        const now = new Date();
        const options = { day: 'numeric', month: 'long', year: 'numeric' };
        
        // Menggunakan Intl API dengan kalender Islam
        // 'id-ID' memastikan nama bulan dalam Bahasa Indonesia (Ramadhan, Syawal, dll)
        // 'u-ca-islamic' memerintahkan browser konversi ke Hijriah
        try {
            let hijriDate = new Intl.DateTimeFormat('id-ID-u-ca-islamic', options).format(now);
            
            // Membersihkan format jika browser menambahkan kata "Tahun"
            hijriDate = hijriDate.replace('Tahun', '').replace('tahun', '').trim();
            
            document.getElementById('tgl-hijri').innerText = hijriDate + "";
        } catch (e) {
            // Fallback sederhana jika browser sangat tua
            document.getElementById('tgl-hijri').innerText = "Kalender Hijriah";
        }
    }

    function updateHadits() {
        const d = new Date().getDate();
        const h = dbHadits[d % dbHadits.length];
        document.getElementById('hadits-content').innerText = `"${h.teks}"`;
        document.getElementById('hadits-rawi').innerText = `‚Äî ${h.rawi}`;
    }

    async function getJadwal() {
        const now = new Date();
        try {
            const res = await fetch(`https://api.myquran.com/v2/sholat/jadwal/${KOTA_ID}/${now.getFullYear()}/${now.getMonth()+1}/${now.getDate()}`);
            const data = await res.json();
            jadwal = data.data.jadwal;
            
            // Update Tanggal Masehi dari API
            document.getElementById('tgl-masehi').innerText = jadwal.tanggal;
            
            renderJadwal();
        } catch (e) { console.log("Gagal ambil data"); }
    }

    function renderJadwal() {
        const list = ['subuh','terbit','dzuhur','ashar','maghrib','isya'];
        const el = document.getElementById('prayer-list');
        el.innerHTML = '';
        list.forEach(k => {
            el.innerHTML += `
                <div class="prayer-card" id="card-${k}">
                    <h3>${k}</h3>
                    <p>${jadwal[k]}</p>
                </div>
            `;
        });
    }

    // --- LOGIKA UTAMA HITUNG MUNDUR ---
    function updateWaktu() {
        const now = new Date();
        
        // 1. Update Jam Besar (HH:MM:SS)
        document.getElementById('jam-besar').innerText = now.toLocaleTimeString('id-ID', { hour12: false });

        if (!jadwal.subuh) return; // Tunggu data API

        const sholat = ['subuh','dzuhur','ashar','maghrib','isya'];
        let nextP = null;
        let diff = 0;

        // 2. Cari Sholat Berikutnya (Hari ini)
        for (let s of sholat) {
            const [h, m] = jadwal[s].split(':').map(Number);
            const target = new Date();
            target.setHours(h, m, 0);

            if (target > now) {
                nextP = s;
                diff = target - now;
                break;
            }
        }

        // 3. Jika semua sholat hari ini sudah lewat, targetnya Subuh Besok
        if (!nextP) {
            nextP = 'subuh';
            const [h, m] = jadwal['subuh'].split(':').map(Number);
            const besok = new Date();
            besok.setDate(besok.getDate() + 1); // Tambah 1 hari
            besok.setHours(h, m, 0);
            diff = besok - now;
        }

        // 4. Update UI
        // Highlight Kartu
        document.querySelectorAll('.prayer-card').forEach(c => c.classList.remove('next'));
        const nextCard = document.getElementById(`card-${nextP}`);
        if(nextCard) nextCard.classList.add('next');

        // Rumus Matematika Konversi Milidetik ke Jam:Menit:Detik
        const hours = Math.floor(diff / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);

        // Format 2 digit (00:00:00)
        const hStr = String(hours).padStart(2, '0');
        const mStr = String(minutes).padStart(2, '0');
        const sStr = String(seconds).padStart(2, '0');

        document.getElementById('label-next').innerText = `MENUJU ${nextP.toUpperCase()}`;
        document.getElementById('timer-kecil').innerText = `${hStr}:${mStr}:${sStr}`;

        // 5. Overlay jika waktu < 10 menit (600.000 ms)
        const overlay = document.getElementById('overlay');
        if (diff <= 600000) {
            overlay.style.display = 'flex';
            document.getElementById('overlay-msg').innerText = `MENUJU ADZAN ${nextP.toUpperCase()}`;
            document.getElementById('overlay-timer').innerText = `${mStr}:${sStr}`;
        } else {
            overlay.style.display = 'none';
        }
    }

    // Jalankan Sistem
    setInterval(updateWaktu, 1000);
    getJadwal();
    updateHadits();
    updateHijri(); // Dipanggil saat halaman dimuat

    // Update Hijriah & Hadits setiap jam (biar berganti hari otomatis tanpa refresh)
    setInterval(() => {
        updateHijri();
        updateHadits();
        getJadwal(); // Refresh jadwal juga setiap jam antisipasi pergantian hari
    }, 3600000); 

</script>
</body>
</html>